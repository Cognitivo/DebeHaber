(window.webpackJsonp=window.webpackJsonp||[]).push([[2],{"Pc/W":function(t,e,a){"use strict";a.r(e);var n=a("gku4"),i={components:{crud:n.a},data:function(){return{data:{date:"",details:[],id:0,number:"",comment:"",template_id:"",template:"",value:""},pageUrl:"/accounting/journals",accountCharts:[],templates:[],lastDeletedRow:[]}},computed:{columns:function(){return[{key:"chart_id",label:this.$i18n.t("commercial.account"),sortable:!0},{key:"credit",label:this.$i18n.t("general.credit"),sortable:!0},{key:"debit",label:this.$i18n.t("general.debit"),sortable:!0},{key:"actions",label:"",sortable:!1}]},Balance:function(){var t=0,e=0;return this.data.details.forEach(function(a){t+=a.debit,e+=a.credit,console.log(a)}),t-e},baseUrl:function(){return"/api/"+this.$route.params.taxPayer+"/"+this.$route.params.cycle}},methods:{onSave:function(){var t=this;t.Balance<0&&n.a.methods.onUpdate(t.baseUrl+t.pageUrl,t.data).then(function(e){t.$snack.success({text:t.$i18n.t("commercial.JournalSaved")}),t.$router.go(-1)}).catch(function(e){t.$snack.danger({text:"Error OMG!: "+e})})},onSaveNew:function(){var t=this;0===t.Balance&&n.a.methods.onUpdate(t.baseUrl+t.pageUrl,t.data).then(function(e){t.$snack.success({text:t.$i18n.t("commercial.JournalSaved")}),t.data.date="",t.data.details=[],t.data.id=0,t.data.number="",t.data.comment="",t.data.template_id="",t.data.template="",t.data.value="",t.$router.push({name:t.$route.name,params:{id:"0"}})}).catch(function(e){t.$snack.danger({text:this.$i18n.t("general.errorMessage")})})},onCancel:function(){var t=this;this.$swal.fire({title:this.$i18n.t("general.cancel"),text:this.$i18n.t("general.cancelVerification"),type:"warning",showCancelButton:!0,confirmButtonText:this.$i18n.t("general.cancelConfirmation"),cancelButtonText:this.$i18n.t("general.cancelRejection")}).then(function(e){e.value&&t.$router.go(-1)})},addDetailRow:function(){this.data.details.push({id:0,chart_id:this.accountCharts[0].id,debit:"0",credit:"0"})},deleteRow:function(t){if(t.id>0){n.a.methods.onDelete(this.baseUrl+this.pageUrl+"/details",t.id).then(function(t){})}this.lastDeletedRow=t,this.$snack.success({text:this.$i18n.t("general.rowDeleted"),button:this.$i18n.t("general.undo"),action:this.undoDeletedRow}),this.data.details.splice(this.data.details.indexOf(t),1)},undoDeletedRow:function(){this.lastDeletedRow.id>0&&n.a.methods.onUpdate(app.baseUrl+app.pageUrl+"/details",this.lastDeletedRow).then(function(t){}),this.data.details.push(this.lastDeletedRow)},onGenerateDetail:function(){var t=this;t.data.template_id=t.data.template.id,t.data.template.details.forEach(function(e){t.data.details.push({id:0,chart_id:e.chart_id,debit:t.data.value*e.debit_coef,credit:t.data.value*e.credit_coef})})}},mounted:function(){var t=this;t.$route.params.id>0?n.a.methods.onRead(t.baseUrl+t.pageUrl+"/"+t.$route.params.id).then(function(e){t.data=e.data.data}):t.data.date=new Date(Date.now()).toISOString().split("T")[0],n.a.methods.onRead(t.baseUrl+"/accounting/charts/for/accountables/").then(function(e){t.accountCharts=e.data.data}),n.a.methods.onRead(t.baseUrl+"/accounting/journal-templates").then(function(e){t.templates=e.data.data})}},r=a("KHd+"),o=Object(r.a)(i,function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",[a("b-row",{staticClass:"mb-5"},[a("b-col",[a("h3",{staticClass:"upper-case"},[a("img",{staticClass:"mr-10",attrs:{src:t.$route.meta.img,alt:"",width:"32"}}),t._v("\n        "+t._s(t.$route.meta.title)+"\n      ")])]),t._v(" "),a("b-col",[a("b-button-toolbar",{staticClass:"float-right d-none d-md-block"},[a("b-button-group",{staticClass:"ml-15"},[a("b-btn",{directives:[{name:"shortkey",rawName:"v-shortkey",value:["ctrl","n"],expression:"['ctrl', 'n']"}],attrs:{variant:"primary"},on:{shortkey:function(e){return t.onSaveNew()},click:function(e){return t.onSaveNew()}}},[a("i",{staticClass:"material-icons"},[t._v("save")]),t._v("\n            "+t._s(t.$t("general.save"))+"\n          ")]),t._v(" "),a("b-btn",{directives:[{name:"shortkey",rawName:"v-shortkey",value:["esc"],expression:"['esc']"}],attrs:{variant:"danger"},on:{shortkey:function(e){return t.onCancel()},click:function(e){return t.onCancel()}}},[a("i",{staticClass:"material-icons"},[t._v("cancel")]),t._v("\n            "+t._s(t.$t("general.cancel"))+"\n          ")])],1)],1)],1)],1),t._v(" "),a("b-card",[a("b-container",[a("b-row",[a("b-col",[a("b-form-group",{attrs:{label:t.$t("commercial.date")}},[a("b-input",{attrs:{type:"date",required:"",placeholder:"Missing Information"},model:{value:t.data.date,callback:function(e){t.$set(t.data,"date",e)},expression:"data.date"}})],1)],1),t._v(" "),a("b-col",[a("b-form-group",{attrs:{label:t.$t("commercial.number")}},[a("b-input",{directives:[{name:"mask",rawName:"v-mask",value:t.spark.taxPayerConfig.document_mask,expression:"spark.taxPayerConfig.document_mask"}],attrs:{type:"text",placeholder:"Invoice Number"},model:{value:t.data.number,callback:function(e){t.$set(t.data,"number",e)},expression:"data.number"}})],1)],1)],1)],1)],1),t._v(" "),a("b-row",[a("b-col",[a("b-card",[a("b-container",[a("b-row",[a("b-col",[a("b-form-group",{attrs:{label:t.$t("general.comment")}},[a("b-input",{attrs:{type:"text",placeholder:t.$t("general.comment")},model:{value:t.data.comment,callback:function(e){t.$set(t.data,"comment",e)},expression:"data.comment"}})],1)],1)],1)],1)],1)],1),t._v(" "),a("b-col",[a("b-card",[a("b-container",[a("b-row",[a("b-col",[a("b-form-group",{attrs:{label:t.$t("accounting.template")}},[a("b-form-select",{model:{value:t.data.template,callback:function(e){t.$set(t.data,"template",e)},expression:"data.template"}},t._l(t.templates,function(e){return a("option",{key:e.key,domProps:{value:e}},[t._v(t._s(e.name))])}),0)],1)],1),t._v(" "),a("b-col",[a("b-form-group",{attrs:{label:t.$t("commercial.value")}},[a("b-input-group-append",[a("b-input",{attrs:{type:"text",placeholder:"Value"},model:{value:t.data.value,callback:function(e){t.$set(t.data,"value",e)},expression:"data.value"}}),t._v(" "),a("b-btn",{attrs:{variant:"primary"},on:{click:function(e){return t.onGenerateDetail()}}},[t._v(t._s(t.$t("general.generate")))])],1)],1)],1)],1)],1)],1)],1)],1),t._v(" "),a("b-row",[a("b-col",[a("b-btn",{directives:[{name:"shortkey",rawName:"v-shortkey",value:["ctrl","d"],expression:"['ctrl', 'd']"}],staticClass:"mb-5",attrs:{size:"sm"},on:{shortkey:function(e){return t.addDetailRow(t.data.details)},click:function(e){return t.addDetailRow(t.data.details)}}},[a("i",{staticClass:"material-icons mi-18"},[t._v("playlist_add")]),t._v("\n        "+t._s(t.$t("general.addRowDetail"))+"\n      ")]),t._v(" "),a("b-card",{attrs:{"no-body":""}},[a("b-table",{attrs:{hover:"",items:t.data.details,fields:t.columns},scopedSlots:t._u([{key:"chart_id",fn:function(e){return[a("b-form-select",{model:{value:e.item.chart_id,callback:function(a){t.$set(e.item,"chart_id",a)},expression:"data.item.chart_id"}},t._l(t.accountCharts,function(e){return a("option",{key:e.key,domProps:{value:e.id}},[t._v(t._s(e.name))])}),0)]}},{key:"debit",fn:function(e){return[a("b-input",{attrs:{type:"text",placeholder:"Debit"},model:{value:e.item.debit,callback:function(a){t.$set(e.item,"debit",a)},expression:"data.item.debit"}})]}},{key:"credit",fn:function(e){return[a("b-input",{attrs:{type:"text",placeholder:"credit"},model:{value:e.item.credit,callback:function(a){t.$set(e.item,"credit",a)},expression:"data.item.credit"}})]}},{key:"actions",fn:function(e){return[a("b-button",{attrs:{variant:"link"},on:{click:function(a){return t.deleteRow(e.item)}}},[a("i",{staticClass:"material-icons text-danger"},[t._v("delete_outline")])])]}}])})],1)],1)],1)],1)},[],!1,null,null,null);e.default=o.exports}}]);